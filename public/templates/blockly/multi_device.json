{
  "category": "Multi-Device",
  "builderType": "blockly",
  "templates": [
    {
      "name": "Voltage Sweep with SMU",
      "description": "Multi-device workflow: SMU voltage sweep with scope measurements using tm_devices",
      "backend": "tm_devices",
      "deviceType": "SCOPE",
      "builderType": "blockly",
      "xml": "<xml xmlns=\"https://developers.google.com/blockly/xml\">\n  <variables>\n    <variable>pk2pk</variable>\n  </variables>\n\n  <block type=\"connect_scope\" id=\"c1\" x=\"20\" y=\"20\">\n    <mutation show_advanced=\"false\" current_backend=\"tm_devices\" current_dev_type=\"SCOPE\" current_conn_type=\"INSTR\"></mutation>\n    <field name=\"DEVICE_NAME\">scope</field>\n    <field name=\"BACKEND\">tm_devices</field>\n    <next>\n      <block type=\"connect_scope\" id=\"c2\">\n        <mutation show_advanced=\"false\" current_backend=\"tm_devices\" current_dev_type=\"SMU\" current_conn_type=\"INSTR\"></mutation>\n        <field name=\"DEVICE_NAME\">smu</field>\n        <field name=\"BACKEND\">tm_devices</field>\n        <next>\n          <block type=\"set_device_context\" id=\"ctx_smu1\">\n            <mutation device=\"smu\"></mutation>\n            <field name=\"DEVICE\">smu</field>\n            <next>\n              <block type=\"python_code\" id=\"smu_out_on\">\n                <field name=\"CODE\">smu.write(\"OUTPut ON\")</field>\n                <next>\n                  <block type=\"controls_for\" id=\"for_v\">\n                    <mutation>\n                      <variable>v</variable>\n                    </mutation>\n                    <field name=\"VAR\">v</field>\n                    <value name=\"FROM\">\n                      <shadow type=\"math_number\" id=\"n_from\">\n                        <field name=\"NUM\">1</field>\n                      </shadow>\n                    </value>\n                    <value name=\"TO\">\n                      <shadow type=\"math_number\" id=\"n_to\">\n                        <field name=\"NUM\">5</field>\n                      </shadow>\n                    </value>\n                    <value name=\"BY\">\n                      <shadow type=\"math_number\" id=\"n_by\">\n                        <field name=\"NUM\">1</field>\n                      </shadow>\n                    </value>\n                    <statement name=\"DO\">\n                      <block type=\"set_device_context\" id=\"ctx_smu2\">\n                        <mutation device=\"smu\"></mutation>\n                        <field name=\"DEVICE\">smu</field>\n                        <next>\n                          <block type=\"python_code\" id=\"smu_set_v\">\n                            <field name=\"CODE\">smu.write(f\":SOURce:VOLTage {v}\")</field>\n                            <next>\n                              <block type=\"set_device_context\" id=\"ctx_scope1\">\n                                <mutation device=\"scope\"></mutation>\n                                <field name=\"DEVICE\">scope</field>\n                                <next>\n                                  <block type=\"acquisition_reset\" id=\"acq_rst\">\n                                    <field name=\"DEVICE_CONTEXT\">(scope)</field>\n                                    <next>\n                                      <block type=\"single_acquisition\" id=\"acq_single\">\n                                        <next>\n                                          <block type=\"wait_for_opc\" id=\"opc1\">\n                                            <field name=\"DEVICE_CONTEXT\">(scope)</field>\n                                            <field name=\"TIMEOUT\">10</field>\n                                            <next>\n                                              <block type=\"measurement_immediate\" id=\"meas_pk2pk\">\n                                                <field name=\"DEVICE_CONTEXT\">(scope)</field>\n                                                <field name=\"TYPE\">PK2PK</field>\n                                                <field name=\"SOURCE\">CH1</field>\n                                                <field name=\"VARIABLE\">pk2pk</field>\n                                              </block>\n                                            </next>\n                                          </block>\n                                        </next>\n                                      </block>\n                                    </next>\n                                  </block>\n                                </next>\n                              </block>\n                            </next>\n                          </block>\n                        </next>\n                      </block>\n                    </statement>\n                    <next>\n                      <block type=\"disconnect\" id=\"disc_smu\">\n                        <field name=\"DEVICE_CONTEXT\">(smu)</field>\n                        <next>\n                          <block type=\"disconnect\" id=\"disc_scope\">\n                            <field name=\"DEVICE_CONTEXT\">(scope)</field>\n                          </block>\n                        </next>\n                      </block>\n                    </next>\n                  </block>\n                </next>\n              </block>\n            </next>\n          </block>\n        </next>\n      </block>\n    </next>\n  </block>\n</xml>"
    }
  ]
}