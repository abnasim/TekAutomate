{
  "description": "Golden reference examples for TekAutomate Steps UI JSON generation",
  "examples": [
    {
      "name": "Complete Step Types Reference",
      "description": "Shows every valid step type with correct params",
      "backend": "pyvisa",
      "deviceType": "SCOPE",
      "steps": [
        {
          "id": "1",
          "type": "connect",
          "label": "Connect to Scope",
          "params": {
            "instrumentIds": [],
            "printIdn": true
          }
        },
        {
          "id": "2",
          "type": "write",
          "label": "Send SCPI Command",
          "params": {
            "command": "CH1:SCALE 1.0"
          }
        },
        {
          "id": "3",
          "type": "query",
          "label": "Query with Variable",
          "params": {
            "command": "*IDN?",
            "saveAs": "idn"
          }
        },
        {
          "id": "4",
          "type": "set_and_query",
          "label": "Set and Verify",
          "params": {
            "command": "CH1:SCALE",
            "cmdParams": [],
            "paramValues": {}
          }
        },
        {
          "id": "5",
          "type": "sleep",
          "label": "Wait 500ms",
          "params": {
            "duration": 0.5
          }
        },
        {
          "id": "6",
          "type": "recall",
          "label": "Recall Factory Settings",
          "params": {
            "recallType": "FACTORY",
            "filePath": "",
            "reference": "REF1"
          }
        },
        {
          "id": "7",
          "type": "recall",
          "label": "Recall Session File",
          "params": {
            "recallType": "SESSION",
            "filePath": "C:/Users/test/setup.tss",
            "reference": "REF1"
          }
        },
        {
          "id": "8",
          "type": "recall",
          "label": "Recall Settings File",
          "params": {
            "recallType": "SETUP",
            "filePath": "C:/Users/test/config.set",
            "reference": "REF1"
          }
        },
        {
          "id": "9",
          "type": "recall",
          "label": "Recall Waveform to REF1",
          "params": {
            "recallType": "WAVEFORM",
            "filePath": "C:/Users/test/golden.wfm",
            "reference": "REF1"
          }
        },
        {
          "id": "10",
          "type": "save_screenshot",
          "label": "Capture Screen (Modern)",
          "params": {
            "filename": "screenshot.png",
            "scopeType": "modern",
            "method": "pc_transfer"
          }
        },
        {
          "id": "11",
          "type": "save_screenshot",
          "label": "Capture Screen (Legacy)",
          "params": {
            "filename": "screenshot.png",
            "scopeType": "legacy",
            "method": "pc_transfer"
          }
        },
        {
          "id": "12",
          "type": "save_waveform",
          "label": "Save Waveform Data",
          "params": {
            "source": "CH1",
            "filename": "waveform.bin",
            "format": "bin",
            "width": 1,
            "encoding": "RIBinary",
            "start": 1,
            "stop": null
          }
        },
        {
          "id": "13",
          "type": "error_check",
          "label": "Check for Errors",
          "params": {
            "command": "ALLEV?"
          }
        },
        {
          "id": "14",
          "type": "comment",
          "label": "Comment",
          "params": {
            "text": "This is a comment - not executed"
          }
        },
        {
          "id": "15",
          "type": "python",
          "label": "Custom Python Code",
          "params": {
            "code": "print(f'IDN: {idn}')\nresult = float(idn.split(',')[2])"
          }
        },
        {
          "id": "16",
          "type": "tm_device_command",
          "label": "tm_devices Command",
          "params": {
            "code": "scope.commands.ch[1].scale.write(1.0)",
            "model": "MSO56",
            "description": "Set CH1 scale using tm_devices"
          }
        },
        {
          "id": "17",
          "type": "disconnect",
          "label": "Disconnect",
          "params": {
            "instrumentIds": []
          }
        }
      ]
    },
    {
      "name": "Groups and Nesting Example",
      "description": "Shows how to organize steps into groups",
      "backend": "pyvisa",
      "steps": [
        {
          "id": "1",
          "type": "connect",
          "label": "Connect",
          "params": {}
        },
        {
          "id": "g1",
          "type": "group",
          "label": "Setup Phase",
          "params": {},
          "collapsed": false,
          "children": [
            {
              "id": "2",
              "type": "write",
              "label": "Reset Scope",
              "params": { "command": "*RST" }
            },
            {
              "id": "3",
              "type": "write",
              "label": "Clear Status",
              "params": { "command": "*CLS" }
            },
            {
              "id": "4",
              "type": "sleep",
              "label": "Wait for Reset",
              "params": { "duration": 1.0 }
            }
          ]
        },
        {
          "id": "g2",
          "type": "group",
          "label": "Channel Configuration",
          "params": {},
          "collapsed": false,
          "children": [
            {
              "id": "5",
              "type": "write",
              "label": "Enable CH1",
              "params": { "command": "DISplay:WAVEView1:CH1:STATE ON" }
            },
            {
              "id": "6",
              "type": "write",
              "label": "Set CH1 Scale",
              "params": { "command": "CH1:SCALE 0.5" }
            },
            {
              "id": "7",
              "type": "write",
              "label": "Set CH1 Position",
              "params": { "command": "CH1:POSITION 2.0" }
            }
          ]
        },
        {
          "id": "g3",
          "type": "group",
          "label": "Acquisition",
          "params": {},
          "collapsed": false,
          "children": [
            {
              "id": "8",
              "type": "write",
              "label": "Single Sequence",
              "params": { "command": "ACQuire:STOPAfter SEQUENCE" }
            },
            {
              "id": "9",
              "type": "write",
              "label": "Start Acquisition",
              "params": { "command": "ACQuire:STATE ON" }
            },
            {
              "id": "10",
              "type": "sleep",
              "label": "Wait for Trigger",
              "params": { "duration": 2.0 }
            },
            {
              "id": "11",
              "type": "query",
              "label": "Wait Complete",
              "params": { "command": "*OPC?", "saveAs": "_opc" }
            }
          ]
        },
        {
          "id": "g4",
          "type": "group",
          "label": "Measurements",
          "params": {},
          "collapsed": false,
          "children": [
            {
              "id": "12",
              "type": "write",
              "label": "Add Pk2Pk Measurement",
              "params": { "command": "MEASUrement:ADDMEAS PK2PK" }
            },
            {
              "id": "13",
              "type": "write",
              "label": "Set Measurement Source",
              "params": { "command": "MEASUrement:MEAS1:SOUrce CH1" }
            },
            {
              "id": "14",
              "type": "query",
              "label": "Read Pk2Pk Value",
              "params": { "command": "MEASUrement:MEAS1:RESUlts:CURRentacq:MEAN?", "saveAs": "pk2pk" }
            }
          ]
        },
        {
          "id": "g5",
          "type": "group",
          "label": "Save Results",
          "params": {},
          "collapsed": false,
          "children": [
            {
              "id": "15",
              "type": "save_screenshot",
              "label": "Capture Screen",
              "params": { "filename": "result.png", "scopeType": "modern" }
            },
            {
              "id": "16",
              "type": "save_waveform",
              "label": "Save CH1 Data",
              "params": { "source": "CH1", "filename": "ch1_data.bin", "format": "bin" }
            }
          ]
        },
        {
          "id": "17",
          "type": "disconnect",
          "label": "Disconnect",
          "params": {}
        }
      ]
    },
    {
      "name": "Measurement Sweep Example",
      "description": "Iterate through scales and capture measurements",
      "backend": "pyvisa",
      "steps": [
        {
          "id": "1",
          "type": "connect",
          "label": "Connect",
          "params": { "printIdn": true }
        },
        {
          "id": "2",
          "type": "write",
          "label": "Delete All Measurements",
          "params": { "command": "MEASUrement:DELETEALL" }
        },
        {
          "id": "3",
          "type": "write",
          "label": "Add Frequency Measurement",
          "params": { "command": "MEASUrement:ADDMEAS FREQUENCY" }
        },
        {
          "id": "g1",
          "type": "group",
          "label": "Scale 1: 1V/div",
          "params": {},
          "children": [
            {
              "id": "4",
              "type": "write",
              "label": "Set Scale 1V",
              "params": { "command": "CH1:SCALE 1.0" }
            },
            {
              "id": "5",
              "type": "sleep",
              "label": "Settle",
              "params": { "duration": 0.5 }
            },
            {
              "id": "6",
              "type": "query",
              "label": "Read Frequency",
              "params": { "command": "MEASUrement:MEAS1:RESUlts:CURRentacq:MEAN?", "saveAs": "freq_1v" }
            },
            {
              "id": "7",
              "type": "save_screenshot",
              "label": "Screenshot 1V",
              "params": { "filename": "scale_1v.png", "scopeType": "modern" }
            }
          ]
        },
        {
          "id": "g2",
          "type": "group",
          "label": "Scale 2: 500mV/div",
          "params": {},
          "children": [
            {
              "id": "8",
              "type": "write",
              "label": "Set Scale 500mV",
              "params": { "command": "CH1:SCALE 0.5" }
            },
            {
              "id": "9",
              "type": "sleep",
              "label": "Settle",
              "params": { "duration": 0.5 }
            },
            {
              "id": "10",
              "type": "query",
              "label": "Read Frequency",
              "params": { "command": "MEASUrement:MEAS1:RESUlts:CURRentacq:MEAN?", "saveAs": "freq_500mv" }
            },
            {
              "id": "11",
              "type": "save_screenshot",
              "label": "Screenshot 500mV",
              "params": { "filename": "scale_500mv.png", "scopeType": "modern" }
            }
          ]
        },
        {
          "id": "g3",
          "type": "group",
          "label": "Scale 3: 100mV/div",
          "params": {},
          "children": [
            {
              "id": "12",
              "type": "write",
              "label": "Set Scale 100mV",
              "params": { "command": "CH1:SCALE 0.1" }
            },
            {
              "id": "13",
              "type": "sleep",
              "label": "Settle",
              "params": { "duration": 0.5 }
            },
            {
              "id": "14",
              "type": "query",
              "label": "Read Frequency",
              "params": { "command": "MEASUrement:MEAS1:RESUlts:CURRentacq:MEAN?", "saveAs": "freq_100mv" }
            },
            {
              "id": "15",
              "type": "save_screenshot",
              "label": "Screenshot 100mV",
              "params": { "filename": "scale_100mv.png", "scopeType": "modern" }
            }
          ]
        },
        {
          "id": "16",
          "type": "python",
          "label": "Print Results",
          "params": {
            "code": "print(f'Frequency at 1V/div: {freq_1v}')\nprint(f'Frequency at 500mV/div: {freq_500mv}')\nprint(f'Frequency at 100mV/div: {freq_100mv}')"
          }
        },
        {
          "id": "17",
          "type": "disconnect",
          "label": "Disconnect",
          "params": {}
        }
      ]
    },
    {
      "name": "Multi-Device Example",
      "description": "Control scope and power supply together",
      "backend": "pyvisa",
      "steps": [
        {
          "id": "1",
          "type": "connect",
          "label": "Connect Scope",
          "params": { "instrumentIds": ["scope-uuid"] },
          "boundDeviceId": "scope-uuid"
        },
        {
          "id": "2",
          "type": "connect",
          "label": "Connect PSU",
          "params": { "instrumentIds": ["psu-uuid"] },
          "boundDeviceId": "psu-uuid"
        },
        {
          "id": "g1",
          "type": "group",
          "label": "Configure PSU",
          "params": {},
          "children": [
            {
              "id": "3",
              "type": "write",
              "label": "Set Voltage 5V",
              "params": { "command": "VOLT 5.0" },
              "boundDeviceId": "psu-uuid"
            },
            {
              "id": "4",
              "type": "write",
              "label": "Set Current Limit",
              "params": { "command": "CURR 0.5" },
              "boundDeviceId": "psu-uuid"
            },
            {
              "id": "5",
              "type": "write",
              "label": "Enable Output",
              "params": { "command": "OUTP ON" },
              "boundDeviceId": "psu-uuid"
            }
          ]
        },
        {
          "id": "6",
          "type": "sleep",
          "label": "Wait for Settle",
          "params": { "duration": 1.0 }
        },
        {
          "id": "g2",
          "type": "group",
          "label": "Measure on Scope",
          "params": {},
          "children": [
            {
              "id": "7",
              "type": "write",
              "label": "Single Acquisition",
              "params": { "command": "ACQuire:STOPAfter SEQUENCE;:ACQuire:STATE ON" },
              "boundDeviceId": "scope-uuid"
            },
            {
              "id": "8",
              "type": "sleep",
              "label": "Wait",
              "params": { "duration": 0.5 }
            },
            {
              "id": "9",
              "type": "query",
              "label": "Read Voltage",
              "params": { "command": "MEASUrement:MEAS1:RESUlts:CURRentacq:MEAN?", "saveAs": "measured_v" },
              "boundDeviceId": "scope-uuid"
            }
          ]
        },
        {
          "id": "10",
          "type": "write",
          "label": "Disable PSU Output",
          "params": { "command": "OUTP OFF" },
          "boundDeviceId": "psu-uuid"
        },
        {
          "id": "11",
          "type": "disconnect",
          "label": "Disconnect All",
          "params": {}
        }
      ]
    },
    {
      "name": "Session Recall and Validation",
      "description": "Load a session file and validate settings",
      "backend": "pyvisa",
      "steps": [
        {
          "id": "1",
          "type": "connect",
          "label": "Connect",
          "params": {}
        },
        {
          "id": "2",
          "type": "recall",
          "label": "Load Test Session",
          "params": {
            "recallType": "SESSION",
            "filePath": "C:/TekScope/Sessions/DDR_Test.tss",
            "reference": "REF1"
          }
        },
        {
          "id": "3",
          "type": "sleep",
          "label": "Wait for Load",
          "params": { "duration": 2.0 }
        },
        {
          "id": "g1",
          "type": "group",
          "label": "Verify Settings",
          "params": {},
          "children": [
            {
              "id": "4",
              "type": "query",
              "label": "Check CH1 Scale",
              "params": { "command": "CH1:SCALE?", "saveAs": "ch1_scale" }
            },
            {
              "id": "5",
              "type": "query",
              "label": "Check Timebase",
              "params": { "command": "HORizontal:SCALE?", "saveAs": "timebase" }
            },
            {
              "id": "6",
              "type": "query",
              "label": "Check Trigger Level",
              "params": { "command": "TRIGger:A:LEVel:CH1?", "saveAs": "trig_level" }
            }
          ]
        },
        {
          "id": "7",
          "type": "python",
          "label": "Validate Settings",
          "params": {
            "code": "print(f'CH1 Scale: {ch1_scale}')\nprint(f'Timebase: {timebase}')\nprint(f'Trigger Level: {trig_level}')\nassert float(ch1_scale) == 0.1, 'CH1 scale mismatch!'"
          }
        },
        {
          "id": "8",
          "type": "disconnect",
          "label": "Disconnect",
          "params": {}
        }
      ]
    },
    {
      "name": "Legacy Scope Screenshot (5k/7k/70k)",
      "description": "Screenshot workflow for older scopes using HARDCOPY",
      "backend": "pyvisa",
      "deviceType": "SCOPE",
      "steps": [
        {
          "id": "1",
          "type": "connect",
          "label": "Connect",
          "params": {}
        },
        {
          "id": "2",
          "type": "write",
          "label": "Configure Acquisition",
          "params": { "command": "ACQuire:STATE ON" }
        },
        {
          "id": "3",
          "type": "sleep",
          "label": "Wait",
          "params": { "duration": 0.5 }
        },
        {
          "id": "4",
          "type": "save_screenshot",
          "label": "Capture (Legacy Method)",
          "params": {
            "filename": "legacy_capture.png",
            "scopeType": "legacy",
            "method": "pc_transfer"
          }
        },
        {
          "id": "5",
          "type": "disconnect",
          "label": "Disconnect",
          "params": {}
        }
      ]
    }
  ],
  "step_type_reference": {
    "connect": {
      "params": ["instrumentIds", "printIdn"],
      "notes": "Always first step. printIdn=true shows *IDN? response"
    },
    "disconnect": {
      "params": ["instrumentIds"],
      "notes": "Always last step. Closes all connections"
    },
    "write": {
      "params": ["command"],
      "notes": "Send SCPI command, no response expected"
    },
    "query": {
      "params": ["command", "saveAs"],
      "notes": "Send SCPI query, saveAs is REQUIRED to store result"
    },
    "set_and_query": {
      "params": ["command", "cmdParams", "paramValues"],
      "notes": "Set value then query to verify"
    },
    "sleep": {
      "params": ["duration"],
      "notes": "Wait in seconds (decimals OK: 0.5 = 500ms)"
    },
    "recall": {
      "params": ["recallType", "filePath", "reference"],
      "notes": "FACTORY=reset, SETUP=.set, SESSION=.tss, WAVEFORM=.wfmâ†’REF"
    },
    "save_screenshot": {
      "params": ["filename", "scopeType", "method"],
      "notes": "scopeType: modern (MSO5/6) or legacy (5k/7k/70k)"
    },
    "save_waveform": {
      "params": ["source", "filename", "format", "width", "encoding", "start", "stop"],
      "notes": "format: bin, wfm, csv"
    },
    "error_check": {
      "params": ["command"],
      "notes": "Usually ALLEV? to read error queue"
    },
    "comment": {
      "params": ["text"],
      "notes": "Not executed, just documentation"
    },
    "python": {
      "params": ["code"],
      "notes": "Custom Python code. Access variables by name"
    },
    "group": {
      "params": [],
      "extra": ["children", "collapsed"],
      "notes": "Container for organizing steps. children is array of steps"
    },
    "tm_device_command": {
      "params": ["code", "model", "description"],
      "notes": "For tm_devices backend only"
    }
  },
  "file_types": {
    ".tss": "Full session (settings + waveforms + measurements)",
    ".set": "Settings only (no waveform data)",
    ".wfm": "Waveform data file"
  },
  "scope_types": {
    "modern": "MSO5, MSO6, MSO5B, MSO6B - uses SAVE:IMAGE",
    "legacy": "MSO/DPO 5k, 7k, 70k series - uses HARDCOPY"
  }
}
